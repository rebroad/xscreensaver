# HexTrail Web Version

A web-based port of the HexTrail screensaver from XScreenSaver, compiled using Emscripten for WebGL 2.0.

## Features

- **Full WebGL 2.0 Support**: Hardware-accelerated 3D graphics
- **Interactive Controls**: Adjust speed, thickness, spin, and wander
- **Mouse Interaction**: Click and drag to rotate, mouse wheel to zoom
- **Keyboard Shortcuts**: F (fullscreen), R (reset), S (toggle spin), W (toggle wander)
- **Responsive Design**: Works on desktop and mobile devices
- **Cross-Platform**: Runs in any modern web browser

## Quick Start

1. **Build the project** (if not already built):
   ```bash
   cd hacks/glx
   ./build_web.sh
   ```

2. **Start a local server**:
   ```bash
   cd web
   python3 -m http.server 8000
   ```

3. **Open in browser**:
   Navigate to `http://localhost:8000/index.html`

## Controls

### Mouse Controls
- **Click and Drag**: Rotate the view
- **Mouse Wheel**: Zoom in/out

### Keyboard Shortcuts
- **F**: Toggle fullscreen mode
- **R**: Reset the animation
- **S**: Toggle spin mode
- **W**: Toggle wander mode
- **ESC**: Exit fullscreen

### UI Controls
- **Speed Slider**: Adjust animation speed (0.1x to 3.0x)
- **Thickness Slider**: Adjust line thickness (0.05 to 0.5)
- **Spin Checkbox**: Enable/disable automatic rotation
- **Wander Checkbox**: Enable/disable wandering motion
- **Reset Button**: Restart the animation
- **Fullscreen Button**: Enter fullscreen mode

## Technical Details

### Architecture
- **Frontend**: HTML5 Canvas + JavaScript
- **Backend**: C/C++ compiled to WebAssembly via Emscripten
- **Graphics**: WebGL 2.0 for hardware acceleration
- **Abstraction Layer**: JWXYZ (JWXYZ Is Not Xlib) for cross-platform compatibility

### Build Process
The build process compiles the original C code with the following modifications:

1. **JWXYZ Abstraction**: Replaces X11 calls with web-compatible equivalents
2. **WebGL Rendering**: Uses WebGL 2.0 instead of OpenGL
3. **Event Handling**: Converts X11 events to web events
4. **Memory Management**: Handles WebAssembly memory constraints

### Files Generated
- `hextrail_web.html`: Main HTML file (auto-generated by Emscripten)
- `hextrail_web.js`: JavaScript glue code
- `hextrail_web.wasm`: WebAssembly binary
- `hextrail_web.data`: Preloaded assets

### Custom Web Interface
- `index.html`: Custom web interface
- `script.js`: JavaScript controller
- `style.css`: Styling for the web interface

## Development

### Prerequisites
- **Emscripten SDK**: Required for compilation
- **Python 3**: For local development server
- **Modern Browser**: Chrome, Firefox, Safari, or Edge

### Building from Source
1. Install Emscripten:
   ```bash
   git clone https://github.com/emscripten-core/emsdk.git
   cd emsdk
   ./emsdk install latest
   ./emsdk activate latest
   source ./emsdk_env.sh
   ```

2. Build the project:
   ```bash
   cd hacks/glx
   ./build_web.sh
   ```

### Modifying the Code
- **C/C++ Code**: Edit `hextrail.c` for core functionality
- **Web Interface**: Edit `web/script.js` for UI behavior
- **Styling**: Edit `web/style.css` for appearance
- **Build Script**: Edit `build_web.sh` for compilation options

## Troubleshooting

### Common Issues

1. **"Emscripten not found"**
   - Install Emscripten SDK and source the environment

2. **"Module not found"**
   - Ensure the web server is running and serving files correctly
   - Check browser console for specific error messages

3. **"WebGL not supported"**
   - Update your browser to a WebGL 2.0 compatible version
   - Enable hardware acceleration in browser settings

4. **"Build failed"**
   - Check that all dependencies are installed
   - Ensure you're running the build script from the correct directory

### Performance Optimization
- **Reduce Canvas Size**: Smaller canvases render faster
- **Lower Quality Settings**: Reduce thickness and complexity
- **Disable Effects**: Turn off spin and wander for better performance

## License

This project is based on XScreenSaver, which is licensed under the MIT License. See the main project README for details.

## Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Test thoroughly
5. Submit a pull request

## Acknowledgments

- **Jamie Zawinski**: Original XScreenSaver creator
- **Emscripten Team**: For making C/C++ web compilation possible
- **WebGL Working Group**: For the WebGL specification 